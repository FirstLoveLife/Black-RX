#+TITLE: config

** Meta
     If you place the following code into your emacs init when saving the
     ~/.dotfiles.org file the dotfiles will all be exported.

#+BEGIN_SRC emacs-lisp :tangle no
       (defun dotfiles-hook ()
         "If the current buffer is '~/.dotfiles.org' the code-blocks are
       tangled."
         (when (equal (buffer-file-name)
                      (expand-file-name (concat (getenv "HOME")
                                        "/.dotfiles.org")))
           (org-babel-tangle)))

       (add-hook 'after-save-hook 'dotfiles-hook)
     #+END_SRC

    

** presuite
*** arch
#+BEGIN_SRC bash
sudo pacman -S fcitx-im fcitx-configtool fcitx-rime librime privoxy aspell-en v2ray
#+END_SRC
** bashrc
#+BEGIN_SRC conf :tangle ~/.bashrc
#+END_SRC

** tmux
#+BEGIN_SRC conf :tangle ~/.tmux.conf
set-option -g default-shell /usr/bin/xonsh
#+END_SRC
** gitconfig
#+BEGIN_SRC quote
firstlove@manjaro ~/projects/github/linux master $ tail /etc/privoxy/config  -n1
forward-socks5 / 127.0.0.1:1092 .
#+END_SRC
#+BEGIN_SRC conf :tangle ~/.gitconfig
[user]
	name = chenli
	email = chenli@uniontech.com
	username = chenli
[core]
	editor = emacs
	whitespace = fix,-indent-with-non-tab,trailing-space,cr-at-eol
	excludesfile = ~/.gitignore
[http]
    proxy = http://127.0.0.1:8118
[https]
    proxy = http://127.0.0.1:8118
#+END_SRC
** gitignore
#+BEGIN_SRC conf :tangle ~/.gitignore
# Compiled source #
###################
,*.com
,*.class
,*.dll
,*.exe
,*.o
,*.so

# Temporary files #
###################
,*.swp
,*.swo
,*~

# Packages #
############
,*.7z
,*.dmg
,*.gz
,*.iso
,*.jar
,*.rar
,*.zip

# Logs #
######################
,*.log

# OS generated files #
######################
.DS_Store*
ehthumbs.db
Icon?
Thumbs.db

,*.lock

# ccls
.ccls-cache/

# c/cpp
*.out
#+END_SRC
** xonsh
#+BEGIN_SRC python :tangle ~/.xonshrc
aliases["p"]='proxychains'
$PATH.append('~/.emacs.d/bin')
$CMAKE_GENERATOR = "Ninja"
$EDITOR = 'emacs'
$XONSH_STORE_STDOUT = True
#+END_SRC
** rime
some useful posts:
- https://gist.github.com/merrickluo/553f39c131d0eb717cd59f72c9d4b60d
- https://github.com/rime/home/wiki/UserGuide#%E5%90%8C%E6%AD%A5%E7%94%A8%E6%88%B6%E8%B3%87%E6%96%99
- https://manateelazycat.github.io/emacs/2019/09/12/make-rime-works-with-linux.html

#+BEGIN_SRC conf :tangle ~/.emacs.d/rime/default.custom.yaml :mkdirp yes
patch:
  menu:
    page_size: 100
  schema_list:
    - schema: luna_pinyin_simp
#+END_SRC
*** arch/manjaro
fcitx-im fcitx-configtool fcitx-rime is necessary to use rime in pyim somehow.
** xmonad
#+BEGIN_SRC conf :tangle ~/.xmonad/xmonad.hs
import qualified XMonad.StackSet as W
import XMonad.Actions.UpdateFocus
import XMonad.Util.EZConfig
import XMonad.Hooks.ManageDocks
import XMonad

myStartupHook :: X()
myStartupHook = do
    -- background
    spawn "bash ~/.screenlayout/arandr.sh"
    spawn "feh --bg-center ~/Downloads/road-landscape-nature-forest-39811.jpg  ~/Downloads/bird-s-eye-photography-of-mountain-1624496.jpg    ~/Downloads/photography-of-person-walking-on-road-1236701.jpg"
    -- autocutsel
    spawn "unclutter -grab &"
    -- redshift
    spawn "redshift -l 21:121"
    -- unclutter
    spawn "unclutter"
    -- compositor
    spawn "picom -b"

main = do
  xmonad $ defaultConfig
    { terminal    = myTerminal
    , modMask     = myModMask
    , focusFollowsMouse = False
    , startupHook        = myStartupHook <+> docksStartupHook
    } `additionalKeysP` myKeys

myTerminal    = "konsole"
myModMask     = mod4Mask -- Win key or Super_L
myBorderWidth = 5

myKeys =
    [
    -- other additional keys
    ]
    ++
    [ (mask ++ "M-" ++ [key], screenWorkspace scr >>= flip whenJust (windows . action))
         | (key, scr)  <- zip "weruio" [2,0,1,2,0,1] -- was [0..] *** change to match your screen order ***
         , (action, mask) <- [ (W.view, "") , (W.shift, "S-")]
    ]
#+END_SRC
** xinitrc
#+BEGIN_SRC conf :tangle ~/.xinitrc :mkdirp yes
# bash ~/.screenlayout/arandr.sh
# feh --bg-center ~/Downloads/road-landscape-nature-forest-39811.jpg  ~/Downloads/bird-s-eye-photography-of-mountain-1624496.jpg    ~/Downloads/photography-of-person-walking-on-road-1236701.jpg
# unclutter -grab &
xmonad
#+END_SRC
** xarand
#+BEGIN_SRC conf :tangle ~/.screenlayout/arandr.sh :mkdirp yes
#!/bin/sh
xrandr --output DisplayPort-1 --mode 3840x2160 --pos 0x0 --rotate left --output DisplayPort-0 --mode 3840x2160 --pos 6000x0 --rotate left --output DisplayPort-2 --primary --mode 3840x2160 --pos 2160x1520 --rotate normal --output DVI-D-0 --off --output HDMI-A-0 --off
#+END_SRC
** org-protocol
*** test
after setting protocol in emacs correctly, use emacsclient to test:
#+BEGIN_SRC conf
emacsclient -n "org-protocol:///capture?url=http%3a%2f%2fduckduckgo%2ecom&title=DuckDuckGo"
#+END_SRC
*** firefox
#+BEGIN_SRC quote
add the following location in a firefox bookmark:
javascript:location.href="org-protocol:///capture?url="+encodeURIComponent(location.href)+"&title="+encodeURIComponent(document.title||"[untitled page]")
#+END_SRC
#+BEGIN_SRC conf :tangle ~/.local/share/applications/org-protocol.desktop
[Desktop Entry]
Name=org-protocol
Exec=emacsclient -n %u
Type=Application
Terminal=false
Categories=System;
MimeType=x-scheme-handler/org-protocol;
#+END_SRC

*** xmonad
#+BEGIN_SRC conf
update-desktop-database ~/.local/share/applications/
#+END_SRC
** termite
#+BEGIN_SRC conf :tangle ~/.config/termite/config :mkdirp yes
[options]
font = Sarasa Term J 30

[colors]
background = rgba(63, 63, 63, 0.8)

#+END_SRC
** cargo
#+BEGIN_SRC conf :tangle ~/.cargo/config :mkdirp yes
[registry]
index = "git://mirrors.ustc.edu.cn/crates.io-index"
#+END_SRC
** picom
#+BEGIN_SRC conf :tangle  ~/.cargo/config :mkdirp yes
opacity-rule = [
  "90:class_g = 'URxvt' && focused",
  "60:class_g = 'URxvt' && !focused"
];
#+END_SRC
